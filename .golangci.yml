version: "2"

linters:
  default: none
  # This list of linters is not a recommendation (same thing for all this configuration file).
  # We intentionally use a limited set of linters.
  enable:
    - bodyclose
    - copyloopvar
    - dogsled
    - dupl
    - errcheck
    - errorlint
    - funlen
    - gocheckcompilerdirectives
    - gochecknoinits
    - goconst
    - gocritic
    - gocyclo
    - godox
    - mnd
    - goprintffuncname
    - gosec
    - govet
    - intrange
    - ineffassign
    - lll
    - misspell
    - nakedret
    - noctx
    - nolintlint
    - revive
    - staticcheck
    - testifylint
    - unconvert
    - unparam
    - unused
    - whitespace

  settings:
    govet:
      enable-all: true
      settings:
        shadow:
          strict: true
    errcheck:
      check-type-assertions: true
    misspell:
      locale: UK
      ignore-words:
        - initialized
    funlen:
      lines: 80
      statements: 40
    gci:
      sections:
        - standard
        - default
        - blank
        - dot
        - alias
      custom-order: true
    revive:
      rules:
        - name: package-comments
          disabled: true
  exclusions:
    generated: lax
    rules:
      - path: _test\.go
        linters:
          - dupl
          - gosec
          - wsl
          - lll
          - funlen
          - nlreturn
          - unused
      - path: _test\.go
        text: "^Error return value is not checked$"
        linters:
          - errcheck
      - text: "^SA1019:.* is deprecated:"
        linters:
          - staticcheck
      - text: "declaration of \"(err|ctx)\" shadows declaration at"
        linters:
          - govet
      - text: "return value of `tx.Rollback` is not checked"
        linters:
          - errcheck

formatters:
  enable:
    - gofmt
    - gci

  settings:
    gofmt:
      simplify: true
      rewrite-rules:
        - pattern: 'interface{}'
          replacement: 'any'
        - pattern: 'a[b:len(a)]'
          replacement: 'a[b:]'
    gci:
      sections:
        - standard
        - default
        - blank
        - dot
        - prefix(github.com/gojekfarm)
      custom-order: true

run:
  skip-dirs:
    - bin
  skip-files:
    - .*mock.*\.go$
    - version.go
    - .*_test\.go$
    - generate.go
  modules-download-mode: readonly
